[logger] capturing stdout/stderr to results/logs/log_2025-11-09-17-21-14.txt
Using device: cuda
英文词汇表大小：10688
中文词汇表大小：3364
示例英文句子索引序列： [2, 3733, 3]
示例中文句子索引序列： [2, 1779, 4, 3]
Epoch 1/40, Train Loss: 5.405, Accuracy: 0.130
Epoch 1/40, Evaluate Loss: 5.405, Accuracy: 0.188
Epoch 2/40, Train Loss: 3.958, Accuracy: 0.201
Epoch 2/40, Evaluate Loss: 3.958, Accuracy: 0.219
Epoch 3/40, Train Loss: 3.475, Accuracy: 0.229
Epoch 3/40, Evaluate Loss: 3.475, Accuracy: 0.236
Epoch 4/40, Train Loss: 3.141, Accuracy: 0.247
Epoch 4/40, Evaluate Loss: 3.141, Accuracy: 0.247
Epoch 5/40, Train Loss: 2.871, Accuracy: 0.264
Epoch 5/40, Evaluate Loss: 2.871, Accuracy: 0.258
Epoch 6/40, Train Loss: 2.634, Accuracy: 0.280
Epoch 6/40, Evaluate Loss: 2.634, Accuracy: 0.266
Epoch 7/40, Train Loss: 2.421, Accuracy: 0.294
Epoch 7/40, Evaluate Loss: 2.421, Accuracy: 0.277
Epoch 8/40, Train Loss: 2.229, Accuracy: 0.310
Epoch 8/40, Evaluate Loss: 2.229, Accuracy: 0.282
Epoch 9/40, Train Loss: 2.049, Accuracy: 0.323
Epoch 9/40, Evaluate Loss: 2.049, Accuracy: 0.287
Epoch 10/40, Train Loss: 1.880, Accuracy: 0.335
Epoch 10/40, Evaluate Loss: 1.880, Accuracy: 0.291
Epoch 11/40, Train Loss: 1.723, Accuracy: 0.349
Epoch 11/40, Evaluate Loss: 1.723, Accuracy: 0.294
Epoch 12/40, Train Loss: 1.572, Accuracy: 0.361
Epoch 12/40, Evaluate Loss: 1.572, Accuracy: 0.295
Epoch 13/40, Train Loss: 1.428, Accuracy: 0.375
Epoch 13/40, Evaluate Loss: 1.428, Accuracy: 0.300
Epoch 14/40, Train Loss: 1.294, Accuracy: 0.388
Epoch 14/40, Evaluate Loss: 1.294, Accuracy: 0.305
Epoch 15/40, Train Loss: 1.165, Accuracy: 0.400
Epoch 15/40, Evaluate Loss: 1.165, Accuracy: 0.305
Epoch 16/40, Train Loss: 1.043, Accuracy: 0.413
Epoch 16/40, Evaluate Loss: 1.043, Accuracy: 0.309
Epoch 17/40, Train Loss: 0.935, Accuracy: 0.424
Epoch 17/40, Evaluate Loss: 0.935, Accuracy: 0.309
Epoch 18/40, Train Loss: 0.831, Accuracy: 0.435
Epoch 18/40, Evaluate Loss: 0.831, Accuracy: 0.308
Epoch 19/40, Train Loss: 0.739, Accuracy: 0.442
Epoch 19/40, Evaluate Loss: 0.739, Accuracy: 0.308
Epoch 20/40, Train Loss: 0.651, Accuracy: 0.455
Epoch 20/40, Evaluate Loss: 0.651, Accuracy: 0.309
Epoch 21/40, Train Loss: 0.571, Accuracy: 0.465
Epoch 21/40, Evaluate Loss: 0.571, Accuracy: 0.310
Epoch 22/40, Train Loss: 0.505, Accuracy: 0.469
Epoch 22/40, Evaluate Loss: 0.505, Accuracy: 0.311
Epoch 23/40, Train Loss: 0.442, Accuracy: 0.477
Epoch 23/40, Evaluate Loss: 0.442, Accuracy: 0.312
Epoch 24/40, Train Loss: 0.387, Accuracy: 0.482
Epoch 24/40, Evaluate Loss: 0.387, Accuracy: 0.313
Epoch 25/40, Train Loss: 0.339, Accuracy: 0.491
Epoch 25/40, Evaluate Loss: 0.339, Accuracy: 0.312
Epoch 26/40, Train Loss: 0.301, Accuracy: 0.494
Epoch 26/40, Evaluate Loss: 0.301, Accuracy: 0.312
Epoch 27/40, Train Loss: 0.266, Accuracy: 0.499
Epoch 27/40, Evaluate Loss: 0.266, Accuracy: 0.313
Epoch 28/40, Train Loss: 0.236, Accuracy: 0.502
Epoch 28/40, Evaluate Loss: 0.236, Accuracy: 0.310
Epoch 29/40, Train Loss: 0.213, Accuracy: 0.506
Epoch 29/40, Evaluate Loss: 0.213, Accuracy: 0.312
Epoch 30/40, Train Loss: 0.189, Accuracy: 0.509
Epoch 30/40, Evaluate Loss: 0.189, Accuracy: 0.310
Epoch 31/40, Train Loss: 0.174, Accuracy: 0.510
Epoch 31/40, Evaluate Loss: 0.174, Accuracy: 0.312
Epoch 32/40, Train Loss: 0.162, Accuracy: 0.513
Epoch 32/40, Evaluate Loss: 0.162, Accuracy: 0.311
Epoch 33/40, Train Loss: 0.149, Accuracy: 0.512
Epoch 33/40, Evaluate Loss: 0.149, Accuracy: 0.311
Epoch 34/40, Train Loss: 0.138, Accuracy: 0.513
Epoch 34/40, Evaluate Loss: 0.138, Accuracy: 0.313
Epoch 35/40, Train Loss: 0.130, Accuracy: 0.511
Epoch 35/40, Evaluate Loss: 0.130, Accuracy: 0.311
Epoch 36/40, Train Loss: 0.124, Accuracy: 0.514
Epoch 36/40, Evaluate Loss: 0.124, Accuracy: 0.310
Epoch 37/40, Train Loss: 0.118, Accuracy: 0.515
Epoch 37/40, Evaluate Loss: 0.118, Accuracy: 0.312
Epoch 38/40, Train Loss: 0.111, Accuracy: 0.515
Epoch 38/40, Evaluate Loss: 0.111, Accuracy: 0.310
Epoch 39/40, Train Loss: 0.107, Accuracy: 0.519
Epoch 39/40, Evaluate Loss: 0.107, Accuracy: 0.315
Epoch 40/40, Train Loss: 0.102, Accuracy: 0.517
Epoch 40/40, Evaluate Loss: 0.102, Accuracy: 0.311
Model saved to results/output/model_stats.txt
Traceback (most recent call last):
  File "/opt/data/private/gaoj/GaoJing/curriculum/Fundamentals_and_Applications_of_Large_Models_jinggao22331159/Transformer/main.py", line 111, in <module>
    val_loss, val_accuracy, high_accuracy_examples = evaluate(model, val_dataloader, device, en_vocab, zh_vocab)
                                                                                     ^^^^^^^^^
NameError: name 'criterion' is not defined
